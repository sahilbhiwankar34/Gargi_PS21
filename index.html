<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RideSmart | Book a Ride</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="css/uber-style.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <a href="index.html">
                <img src="logo/logo.png" alt="RideSmart" class="logo-img">
                <span class="logo-text">RideSmart</span>
            </a>
        </div>
        <nav class="nav-menu">
            <a href="#" class="nav-link active">Ride</a>
            <a href="#" class="nav-link">Activity</a>
            <a href="Admin/dashboard.html" class="nav-link">Admin</a>
        </nav>
        <div class="user-menu">
            <button class="help-btn">Help</button>
            <!-- Guest View -->
            <div id="guestMenu">
                <a href="login.html" class="login-btn">Log in</a>
                <a href="login.html#signup" class="signup-btn">Sign up</a>
            </div>
            <!-- User View -->
            <div id="userMenu" style="display:none;">
                <div class="user-dropdown">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="dropdown-content">
                        <div class="dropdown-header">
                            <strong id="userName">User</strong>
                            <small id="userEmail">user@email.com</small>
                        </div>
                        <a href="#" class="dropdown-item">My Rides</a>
                        <a href="#" class="dropdown-item">Settings</a>
                        <a href="#" class="dropdown-item" onclick="logout()">Log out</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Sidebar - Booking Panel -->
        <aside class="sidebar" id="bookingPanel">
            <div class="sidebar-content">
                <h1 class="sidebar-title">Get a ride</h1>

                <!-- Location Inputs with Autocomplete -->
                <div class="location-inputs">
                    <div class="input-group">
                        <div class="input-icon pickup-icon"></div>
                        <input type="text" id="pickupInput" class="location-input" placeholder="Enter pickup location"
                            autocomplete="off">
                        <button class="location-btn" onclick="useCurrentLocation('pickup')"
                            title="Use current location">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="3" />
                                <path d="M12 2v4m0 12v4M2 12h4m12 0h4" />
                            </svg>
                        </button>
                        <!-- Pickup Suggestions Dropdown -->
                        <div class="location-suggestions" id="pickupSuggestions"></div>
                    </div>
                    <div class="input-connector"></div>
                    <div class="input-group">
                        <div class="input-icon drop-icon"></div>
                        <input type="text" id="dropInput" class="location-input" placeholder="Where to?"
                            autocomplete="off">
                        <!-- Drop Suggestions Dropdown -->
                        <div class="location-suggestions" id="dropSuggestions"></div>
                    </div>
                </div>

                <!-- Saved Places -->
                <div class="saved-places" id="savedPlaces">
                    <div class="saved-place" onclick="selectSavedPlace('home')">
                        <span class="place-icon">üè†</span>
                        <div class="place-info">
                            <div class="place-name">Home</div>
                            <div class="place-address">Add home address</div>
                        </div>
                    </div>
                    <div class="saved-place" onclick="selectSavedPlace('work')">
                        <span class="place-icon">üíº</span>
                        <div class="place-info">
                            <div class="place-name">Work</div>
                            <div class="place-address">Add work address</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Locations -->
                <div class="recent-locations" id="recentLocations">
                    <h3 class="section-title">Recent</h3>
                    <div id="recentList"></div>
                </div>

                <!-- Ride Options (Hidden initially) -->
                <div class="ride-options" id="rideOptions" style="display:none;">
                    <h3 class="options-title">Choose a ride</h3>

                    <div class="ride-option selected" data-type="standard">
                        <div class="ride-car">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath fill='%23333' d='M52 28l-4-12c-1-3-4-5-7-5H23c-3 0-6 2-7 5l-4 12c-3 1-5 4-5 7v9c0 2 1 3 3 3h2c2 0 3-1 3-3v-2h34v2c0 2 1 3 3 3h2c2 0 3-1 3-3v-9c0-3-2-6-5-7z'/%3E%3Ccircle fill='%23555' cx='18' cy='44' r='5'/%3E%3Ccircle fill='%23555' cx='46' cy='44' r='5'/%3E%3Cpath fill='%2300A3FF' d='M16 22l3-8c.5-1.5 2-2.5 3.5-2.5h19c1.5 0 3 1 3.5 2.5l3 8H16z'/%3E%3C/svg%3E"
                                alt="Car" class="car-icon">
                        </div>
                        <div class="ride-info">
                            <div class="ride-name">RideSmart</div>
                            <div class="ride-desc"><span id="nearbyTaxis">--</span> nearby ‚Ä¢ <span
                                    id="standardETA">--</span> min</div>
                        </div>
                        <div class="ride-price" id="standardPrice">‚Çπ--</div>
                    </div>

                    <div class="ride-option" data-type="premium">
                        <div class="ride-car">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath fill='%23000' d='M52 28l-4-12c-1-3-4-5-7-5H23c-3 0-6 2-7 5l-4 12c-3 1-5 4-5 7v9c0 2 1 3 3 3h2c2 0 3-1 3-3v-2h34v2c0 2 1 3 3 3h2c2 0 3-1 3-3v-9c0-3-2-6-5-7z'/%3E%3Ccircle fill='%23333' cx='18' cy='44' r='5'/%3E%3Ccircle fill='%23333' cx='46' cy='44' r='5'/%3E%3Cpath fill='%23FFD700' d='M16 22l3-8c.5-1.5 2-2.5 3.5-2.5h19c1.5 0 3 1 3.5 2.5l3 8H16z'/%3E%3C/svg%3E"
                                alt="Car" class="car-icon">
                        </div>
                        <div class="ride-info">
                            <div class="ride-name">RideSmart Premium</div>
                            <div class="ride-desc">Luxury rides</div>
                        </div>
                        <div class="ride-price" id="premiumPrice">‚Çπ--</div>
                    </div>
                </div>

                <!-- Passenger Info (Hidden initially) -->
                <div class="passenger-info" id="passengerInfo" style="display:none;">
                    <input type="text" id="passengerName" class="passenger-input" placeholder="Your name">
                    <input type="tel" id="passengerPhone" class="passenger-input" placeholder="Phone number">
                </div>

                <!-- Book Button -->
                <button class="book-btn" id="bookBtn" disabled>
                    <span class="btn-text">Select locations</span>
                    <span class="btn-loader"></span>
                </button>

                <!-- Traffic Alert -->
                <div class="traffic-alert" id="trafficAlert" style="display:none;">
                    <span class="alert-icon">‚ö†Ô∏è</span>
                    <div class="alert-text">
                        <strong>Traffic Alert</strong>
                        <span id="trafficDetails">Heavy traffic on route</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Confirmation Panel -->
        <aside class="sidebar confirmation-panel" id="confirmationPanel" style="display:none;">
            <div class="sidebar-content">
                <div class="confirmation-header">
                    <button class="back-btn" onclick="cancelRide()">‚Üê</button>
                    <h2>Driver is on the way</h2>
                </div>

                <!-- Driver Card -->
                <div class="driver-card">
                    <div class="driver-info">
                        <div class="driver-avatar" id="driverAvatar">D</div>
                        <div class="driver-details">
                            <div class="driver-name" id="driverName">Driver Name</div>
                            <div class="driver-rating">‚≠ê <span id="driverRating">4.9</span></div>
                        </div>
                        <button class="contact-btn">üìû</button>
                    </div>
                    <div class="car-details">
                        <div class="car-number" id="carNumber">XX XX XX 0000</div>
                        <div class="car-model" id="carModel">Vehicle Model</div>
                    </div>
                </div>

                <!-- ETA Display -->
                <div class="eta-display">
                    <div class="eta-circle">
                        <span class="eta-time" id="etaTime">--</span>
                        <span class="eta-label">min</span>
                    </div>
                    <p class="eta-text">Arriving in <span id="etaMinutes">--</span> minutes</p>
                </div>

                <!-- Ride Status Tracker -->
                <div class="ride-status-tracker">
                    <div class="status-step active">
                        <div class="step-dot"></div>
                        <span>Driver assigned</span>
                    </div>
                    <div class="status-step">
                        <div class="step-dot"></div>
                        <span>On the way to pickup</span>
                    </div>
                    <div class="status-step">
                        <div class="step-dot"></div>
                        <span>Arrived at pickup</span>
                    </div>
                    <div class="status-step">
                        <div class="step-dot"></div>
                        <span>Trip in progress</span>
                    </div>
                </div>

                <!-- Trip Summary -->
                <div class="trip-summary">
                    <div class="summary-row">
                        <span>Distance</span>
                        <span id="tripDistance">-- km</span>
                    </div>
                    <div class="summary-row">
                        <span>Est. Duration</span>
                        <span id="tripDuration">-- min</span>
                    </div>
                    <div class="summary-row">
                        <span>Ride Code</span>
                        <code id="rideCode">------</code>
                    </div>
                </div>

                <!-- Traffic Alert -->
                <div class="traffic-alert" id="confirmTrafficAlert" style="display:none;">
                    <span class="alert-icon">üö¶</span>
                    <div class="alert-text">
                        <strong>Route Optimized</strong>
                        <span id="confirmTrafficDetails">Avoiding traffic on main route</span>
                    </div>
                </div>

                <!-- Cancel Button -->
                <button class="cancel-btn" onclick="cancelRide()">Cancel Ride</button>
            </div>
        </aside>

        <!-- Map Container -->
        <div class="map-container">
            <div id="map"></div>

            <!-- Taxis Counter -->
            <div class="taxis-counter">
                <span class="counter-icon">üöï</span>
                <span><strong id="taxiCount">0</strong> taxis nearby</span>
            </div>

            <!-- Map Controls -->
            <div class="map-controls">
                <button class="map-btn" onclick="centerOnUser()" title="My location">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path d="M12 2v4m0 12v4M2 12h4m12 0h4" />
                    </svg>
                </button>
                <button class="map-btn" onclick="refreshTaxis()" title="Refresh taxis">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 4v6h6M23 20v-6h-6" />
                        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" />
                    </svg>
                </button>
            </div>

            <!-- Selection Mode Indicator -->
            <div class="selection-mode" id="selectionMode">
                <div class="mode-content">
                    <span class="mode-icon" id="modeIcon">üìç</span>
                    <span id="modeText">Click to set pickup location</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/uber-app.js"></script>
</body>

</html>